function fb_invite_listener(){
	if (".new_invitation_fb"){
		access_token = $.cookie("fb_access");
		FB.api('/me/friends?access_token='+access_token, function(friends){
			fb_invitation_autocomplete(friends);

		});
	}
}



function fb_invitation_autocomplete(friends){
	var formatted = [];
	for(var i = 0; i< friends.data.length; i++) {
		if (friends.data[i].name.toLowerCase().indexOf($('#fb_name').val().toLowerCase()) >= 0){
			formatted.push({
				label: friends.data[i].name,
				value: friends.data[i].id
			});
		}
	}
	$("#fb_name").autocomplete({
		source: function(request, response){
			var matches = $.map(formatted, function(tag){

				if (tag.label.toUpperCase().indexOf(request.term.toUpperCase()) === 0){
					return tag;
				}
			});
			response(matches);
		},
		select: function(event, ui) {
			$('#fb_name').val(ui.item.label)
			$('#invitation_fb_id').val(ui.item.value)
			FB.ui({
				method: 'send',
				link: '<%= FULL_ROOT %>',
				to: ui.item.value
			},
			function(response){
				if (response == 'success'){
					//ENTER CALLBACK FOR NEW INVITATION HERE
				}
			}
			);

			return false;
		},
		minLength: 2

	});
}